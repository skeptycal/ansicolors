parameters:
- name: projectId
  type: string
  default: ''
- name: pipelineId
  type: string
  default: ''

steps:
  - checkout: none
  - download: none
  - task: DownloadPipelineArtifact@2
    displayName: Download Pipeline Artifacts
    inputs:
      source: 'specific'
      project: '${{ parameters.projectId }}'
      pipeline: '${{ parameters.pipelineId }}'
      preferTriggeringPipeline: true
      runVersion: 'latestFromBranch'
      runBranch: '$(Build.SourceBranch)'
      path: $(Build.SourcesDirectory)/bin
  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        # Print JSON
        cat $(Build.SourcesDirectory)/bin/model/model.json | jq '.'

        # Set model name and version variables as strings
        MODEL_NAME=$(jq '.name' <$(Build.SourcesDirectory)/bin/model/model.json)
        MODEL_VERSION=$(jq '.version' <$(Build.SourcesDirectory)/bin/model/model.json)

        echo "Model Name: $MODEL_NAME"
        echo "Model Version: $MODEL_VERSION"

        echo "##vso[task.setvariable variable=MODEL_VERSION]$MODEL_VERSION"
        echo "##vso[task.setvariable variable=MODEL_NAME]$MODEL_NAME"